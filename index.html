<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Journal Pro - –î–Ω–µ–≤–Ω–∏–∫ —Å–¥–µ–ª–æ–∫ —Ç—Ä–µ–π–¥–µ—Ä–∞</title>
    <style>
        :root {
            --color-white: rgba(255, 255, 255, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-gray-400: rgba(119, 124, 124, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-slate-900: rgba(19, 52, 59, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-400: rgba(45, 166, 178, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-teal-700: rgba(26, 104, 115, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-green-500: rgba(34, 197, 94, 1);
            
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: var(--color-slate-900);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-success: var(--color-green-500);
            --color-error: var(--color-red-500);
            --color-border: rgba(94, 82, 64, 0.2);
            
            --font-family-base: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            --font-family-mono: 'Berkeley Mono', ui-monospace, monospace;
            --font-size-sm: 12px;
            --font-size-base: 14px;
            --font-size-md: 16px;
            --font-size-lg: 18px;
            --font-size-xl: 20px;
            --font-size-2xl: 24px;
            --font-weight-normal: 400;
            --font-weight-medium: 500;
            --font-weight-semibold: 600;
            
            --space-4: 4px;
            --space-8: 8px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --space-32: 32px;
            
            --radius-sm: 6px;
            --radius-base: 8px;
            --radius-md: 10px;
            --radius-lg: 12px;
            
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family-base);
            background-color: var(--color-background);
            color: var(--color-text);
            line-height: 1.5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: var(--space-16);
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--color-teal-500) 0%, var(--color-teal-600) 100%);
            color: white;
            padding: var(--space-32) var(--space-16);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-32);
            box-shadow: var(--shadow-md);
        }

        .header h1 {
            font-size: var(--font-size-2xl);
            margin-bottom: var(--space-8);
        }

        .header p {
            font-size: var(--font-size-sm);
            opacity: 0.95;
            margin: 0;
        }

        /* Main Grid */
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-24);
            margin-bottom: var(--space-32);
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Form Section */
        .form-section {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            box-shadow: var(--shadow-sm);
        }

        .form-section h2 {
            font-size: var(--font-size-lg);
            margin-bottom: var(--space-20);
            color: var(--color-slate-900);
        }

        .form-group {
            margin-bottom: var(--space-16);
        }

        .form-label {
            display: block;
            font-size: var(--font-size-sm);
            font-weight: var(--font-weight-medium);
            margin-bottom: var(--space-8);
            color: var(--color-text);
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: var(--space-12) var(--space-12);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            font-family: var(--font-family-base);
            font-size: var(--font-size-base);
            background-color: var(--color-white);
            color: var(--color-text);
            transition: border-color 0.2s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(33, 128, 141, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-12);
        }

        .btn {
            padding: var(--space-12) var(--space-20);
            border: none;
            border-radius: var(--radius-base);
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background-color: var(--color-primary);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            background-color: var(--color-primary-hover);
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .btn-secondary {
            background-color: transparent;
            border: 1px solid var(--color-border);
            color: var(--color-text);
            width: auto;
            margin-right: var(--space-12);
        }

        .btn-secondary:hover {
            background-color: var(--color-gray-200);
        }

        .btn-danger {
            background-color: var(--color-red-400);
            color: white;
            padding: var(--space-8) var(--space-12);
            font-size: var(--font-size-sm);
        }

        .btn-danger:hover {
            background-color: var(--color-red-500);
        }

        /* Statistics Section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-16);
            margin-bottom: var(--space-24);
        }

        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .stat-card {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            padding: var(--space-16);
            text-align: center;
        }

        .stat-label {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-8);
        }

        .stat-value {
            font-size: var(--font-size-xl);
            font-weight: var(--font-weight-semibold);
            color: var(--color-text);
        }

        .stat-value.positive {
            color: var(--color-success);
        }

        .stat-value.negative {
            color: var(--color-error);
        }

        /* Recommendations */
        .recommendations {
            background: linear-gradient(135deg, rgba(50, 184, 198, 0.1) 0%, rgba(33, 128, 141, 0.05) 100%);
            border: 1px solid rgba(33, 128, 141, 0.3);
            border-radius: var(--radius-lg);
            padding: var(--space-20);
            margin-bottom: var(--space-24);
        }

        .recommendations h3 {
            font-size: var(--font-size-md);
            margin-bottom: var(--space-12);
            color: var(--color-teal-600);
        }

        .recommendation-item {
            background: white;
            padding: var(--space-12);
            border-radius: var(--radius-base);
            margin-bottom: var(--space-8);
            font-size: var(--font-size-sm);
            border-left: 3px solid var(--color-teal-500);
            padding-left: var(--space-16);
        }

        .recommendation-item:last-child {
            margin-bottom: 0;
        }

        .recommendation-item strong {
            color: var(--color-teal-600);
        }

        /* Trades Table */
        .trades-section {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            padding: var(--space-24);
            box-shadow: var(--shadow-sm);
        }

        .trades-section h2 {
            font-size: var(--font-size-lg);
            margin-bottom: var(--space-20);
            color: var(--color-slate-900);
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: var(--font-size-sm);
        }

        th {
            background-color: var(--color-gray-200);
            padding: var(--space-12);
            text-align: left;
            font-weight: var(--font-weight-semibold);
            border-bottom: 2px solid var(--color-border);
        }

        td {
            padding: var(--space-12);
            border-bottom: 1px solid var(--color-border);
        }

        tr:hover {
            background-color: var(--color-gray-200);
        }

        .trade-positive {
            color: var(--color-success);
            font-weight: var(--font-weight-medium);
        }

        .trade-negative {
            color: var(--color-error);
            font-weight: var(--font-weight-medium);
        }

        .empty-state {
            text-align: center;
            padding: var(--space-32);
            color: var(--color-text-secondary);
        }

        .empty-state p {
            font-size: var(--font-size-base);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: var(--space-8);
            margin-bottom: var(--space-20);
            border-bottom: 2px solid var(--color-border);
        }

        .tab-btn {
            padding: var(--space-12) var(--space-16);
            background: none;
            border: none;
            cursor: pointer;
            font-size: var(--font-size-base);
            font-weight: var(--font-weight-medium);
            color: var(--color-text-secondary);
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
        }

        .tab-btn.active {
            color: var(--color-primary);
            border-bottom-color: var(--color-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Export Button */
        .export-section {
            margin-top: var(--space-24);
            padding-top: var(--space-24);
            border-top: 1px solid var(--color-border);
        }

        .btn-export {
            background-color: var(--color-teal-400);
            color: white;
            padding: var(--space-12) var(--space-20);
        }

        .btn-export:hover {
            background-color: var(--color-teal-500);
        }

        /* Info Box */
        .info-box {
            background-color: rgba(33, 128, 141, 0.08);
            border-left: 4px solid var(--color-teal-500);
            padding: var(--space-16);
            border-radius: var(--radius-base);
            margin-bottom: var(--space-20);
            font-size: var(--font-size-sm);
        }

        .info-box strong {
            color: var(--color-teal-600);
        }

        /* Risk Summary */
        .risk-summary {
            background: var(--color-surface);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            padding: var(--space-16);
            margin-top: var(--space-16);
        }

        .risk-summary h4 {
            font-size: var(--font-size-base);
            margin-bottom: var(--space-12);
            color: var(--color-slate-900);
        }

        .risk-bar {
            background-color: var(--color-gray-200);
            border-radius: var(--radius-sm);
            height: 8px;
            overflow: hidden;
            margin-bottom: var(--space-8);
        }

        .risk-bar-fill {
            height: 100%;
            background-color: var(--color-teal-500);
            transition: width 0.3s;
        }

        .risk-text {
            font-size: var(--font-size-sm);
            color: var(--color-text-secondary);
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .main-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üìä Trading Journal Pro</h1>
            <p>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –¥–Ω–µ–≤–Ω–∏–∫ —Å–¥–µ–ª–æ–∫ —Å –∞–Ω–∞–ª–∏–∑–æ–º —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏</p>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Left Column: Form -->
            <div>
                <div class="form-section">
                    <h2>üìù –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å–¥–µ–ª–∫—É</h2>

                    <div class="info-box">
                        <strong>üí° –°–æ–≤–µ—Ç:</strong> –ó–∞–ø–æ–ª–Ω—è–π —Ñ–æ—Ä–º—É –°–†–ê–ó–£ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è —Å–¥–µ–ª–∫–∏, –ø–æ–∫–∞ –ø–æ–º–Ω–∏—à—å –≤—Å–µ –¥–µ—Ç–∞–ª–∏.
                    </div>

                    <form id="tradeForm">
                        <div class="form-group">
                            <label class="form-label">–î–∞—Ç–∞ —Å–¥–µ–ª–∫–∏</label>
                            <input type="date" id="tradeDate" class="form-input" required>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">–ú–æ–Ω–µ—Ç–∞ (BTC, ETH, ADA...)</label>
                                <input type="text" id="tradeCoin" class="form-input" placeholder="BTC" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">–¢–∏–ø —Å–¥–µ–ª–∫–∏</label>
                                <select id="tradeType" class="form-select" required>
                                    <option value="">–í—ã–±–µ—Ä–∏ —Ç–∏–ø</option>
                                    <option value="long">üìà –õ–û–ù–ì (–ø–æ–∫—É–ø–∫–∞)</option>
                                    <option value="short">üìâ –®–û–†–¢ (–ø—Ä–æ–¥–∞–∂–∞)</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">–¶–µ–Ω–∞ –≤—Ö–æ–¥–∞ ($)</label>
                                <input type="number" id="entryPrice" class="form-input" placeholder="42000" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">–¶–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞ ($)</label>
                                <input type="number" id="exitPrice" class="form-input" placeholder="42500" step="0.01" required>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">–¶–µ–Ω–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞ ($)</label>
                                <input type="number" id="stopLoss" class="form-input" placeholder="41500" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">–†–∞–∑–º–µ—Ä —Å—Ç–∞–≤–∫–∏ (–æ–±—ä–µ–º)</label>
                                <input type="number" id="positionSize" class="form-input" placeholder="0.05" step="0.001" required>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">–î–µ–ø–æ–∑–∏—Ç –≤ –º–æ–º–µ–Ω—Ç –≤—Ö–æ–¥–∞ ($)</label>
                            <input type="number" id="accountSize" class="form-input" placeholder="1000" step="1" required>
                        </div>

                        <div class="form-group">
                            <label class="form-label">–ü—Ä–∏—á–∏–Ω–∞ –≤—Ö–æ–¥–∞ (—É–∫–∞–∂–∏ —Å–∏–≥–Ω–∞–ª)</label>
                            <select id="reason" class="form-select" required>
                                <option value="">–í—ã–±–µ—Ä–∏ –ø—Ä–∏—á–∏–Ω—É</option>
                                <option value="support">üîß –û—Ç—Å–∫–æ–∫ –æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏</option>
                                <option value="resistance">‚ö™ –ü—Ä–æ–±–æ–π —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è</option>
                                <option value="trend">üìà –ê–ø–æ—Ç—Ä–µ–Ω–¥ (–º–Ω–æ–≥–æ –∑–µ–ª–µ–Ω—ã—Ö —Å–≤–µ—á–µ–π)</option>
                                <option value="dip">üìâ –ü–∞–¥–µ–Ω–∏–µ (–ø–æ–∫—É–ø–∞—é –Ω–∞ –¥–∏–ø–µ)</option>
                                <option value="breakout">üí• –ü—Ä–æ—Ä—ã–≤ —É—Ä–æ–≤–Ω—è</option>
                                <option value="news">üì∞ –ù–æ–≤–æ—Å—Ç—å / —Å–æ–±—ã—Ç–∏–µ</option>
                                <option value="fomo">üò± FOMO (–≤—Å–µ –ø–æ–∫—É–ø–∞—é—Ç)</option>
                                <option value="other">ü§î –î—Ä—É–≥–æ–µ</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                            <textarea id="comment" class="form-textarea" placeholder="–ß—Ç–æ —Ç—ã –¥—É–º–∞–ª –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º?"></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–¥–µ–ª–∫—É</button>
                    </form>
                </div>
            </div>

            <!-- Right Column: Stats & Recommendations -->
            <div>
                <!-- Statistics -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">–í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫</div>
                        <div class="stat-value" id="totalTrades">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥</div>
                        <div class="stat-value" id="winRate">0%</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–û–±—â–∞—è P&L</div>
                        <div class="stat-value" id="totalPnL">$0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–†–∏—Å–∫/–ù–∞–≥—Ä–∞–¥–∞</div>
                        <div class="stat-value" id="riskReward">0:0</div>
                    </div>
                </div>

                <!-- Risk Analysis -->
                <div class="risk-summary">
                    <h4>üéØ –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–¥–µ–ª–æ–∫)</h4>
                    <div class="risk-bar">
                        <div class="risk-bar-fill" id="riskBar"></div>
                    </div>
                    <div class="risk-text" id="riskText">–î–æ–±–∞–≤—å —Å–¥–µ–ª–∫—É —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∞–Ω–∞–ª–∏–∑</div>
                </div>

                <!-- Recommendations -->
                <div class="recommendations">
                    <h3>üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∏—Å–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É</h3>
                    <div id="recommendationsContainer">
                        <div class="recommendation-item">
                            <strong>üìù –ö–∞–∫ –Ω–∞—á–∞—Ç—å:</strong> –î–æ–±–∞–≤—å —Å–≤–æ—é –ø–µ—Ä–≤—É—é —Å–¥–µ–ª–∫—É, –∏ —è –¥–∞–º —Ç–µ–±–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Trades History -->
        <div class="trades-section">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-20);">
                <h2>üìä –ò—Å—Ç–æ—Ä–∏—è —Å–¥–µ–ª–æ–∫</h2>
                <button class="btn btn-export" onclick="exportToCSV()">üì• –°–∫–∞—á–∞—Ç—å CSV</button>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab('all')">–í—Å–µ —Å–¥–µ–ª–∫–∏</button>
                <button class="tab-btn" onclick="switchTab('winners')">‚úÖ –ü–æ–±–µ–¥—ã</button>
                <button class="tab-btn" onclick="switchTab('losses')">‚ùå –ü–æ—Ä–∞–∂–µ–Ω–∏—è</button>
            </div>

            <div id="all" class="tab-content active">
                <div class="table-container">
                    <table id="allTradesTable">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ú–æ–Ω–µ—Ç–∞</th>
                                <th>–¢–∏–ø</th>
                                <th>–í—Ö–æ–¥ / –í—ã—Ö–æ–¥</th>
                                <th>–†–∞–∑–º–µ—Ä</th>
                                <th>–†–∏—Å–∫</th>
                                <th>P&L</th>
                                <th>%</th>
                                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                            </tr>
                        </thead>
                        <tbody id="allTradesBody">
                            <tr><td colspan="9" class="empty-state"><p>–ù–µ—Ç —Å–¥–µ–ª–æ–∫. –î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é! üöÄ</p></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="winners" class="tab-content">
                <div class="table-container">
                    <table id="winnersTradesTable">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ú–æ–Ω–µ—Ç–∞</th>
                                <th>–í—Ö–æ–¥ / –í—ã—Ö–æ–¥</th>
                                <th>P&L</th>
                                <th>%</th>
                            </tr>
                        </thead>
                        <tbody id="winnersTradesBody">
                            <tr><td colspan="5" class="empty-state"><p>–ï—â–µ –Ω–µ—Ç –ø–æ–±–µ–¥. –ë—É–¥—É—Ç! üí™</p></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="losses" class="tab-content">
                <div class="table-container">
                    <table id="lossesTradesTable">
                        <thead>
                            <tr>
                                <th>–î–∞—Ç–∞</th>
                                <th>–ú–æ–Ω–µ—Ç–∞</th>
                                <th>–í—Ö–æ–¥ / –í—ã—Ö–æ–¥</th>
                                <th>P&L</th>
                                <th>%</th>
                            </tr>
                        </thead>
                        <tbody id="lossesTradesBody">
                            <tr><td colspan="5" class="empty-state"><p>–ï—â–µ –Ω–µ—Ç –ø–æ—Ä–∞–∂–µ–Ω–∏–π. –ë—É–¥—É—Ç —É—á–∏—Ç—å—Å—è! üìö</p></td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <script>
        // Initialize with today's date
        document.getElementById('tradeDate').valueAsDate = new Date();

        // Load trades from localStorage
        let trades = JSON.parse(localStorage.getItem('trades')) || [];

        // Form submission
        document.getElementById('tradeForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const trade = {
                id: Date.now(),
                date: document.getElementById('tradeDate').value,
                coin: document.getElementById('tradeCoin').value.toUpperCase(),
                type: document.getElementById('tradeType').value,
                entryPrice: parseFloat(document.getElementById('entryPrice').value),
                exitPrice: parseFloat(document.getElementById('exitPrice').value),
                stopLoss: parseFloat(document.getElementById('stopLoss').value),
                positionSize: parseFloat(document.getElementById('positionSize').value),
                accountSize: parseFloat(document.getElementById('accountSize').value),
                reason: document.getElementById('reason').value,
                comment: document.getElementById('comment').value,
                timestamp: Date.now()
            };

            trades.push(trade);
            localStorage.setItem('trades', JSON.stringify(trades));

            // Reset form
            document.getElementById('tradeForm').reset();
            document.getElementById('tradeDate').valueAsDate = new Date();

            updateUI();
            alert('‚úÖ –°–¥–µ–ª–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞! –°–ø–∞—Å–∏–±–æ –∑–∞ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—É! üöÄ');
        });

        function updateUI() {
            updateStats();
            updateRecommendations();
            renderTrades();
        }

        function updateStats() {
            const totalTrades = trades.length;
            const winners = trades.filter(t => t.type === 'long' ? t.exitPrice > t.entryPrice : t.exitPrice < t.entryPrice).length;
            const winRate = totalTrades > 0 ? Math.round((winners / totalTrades) * 100) : 0;

            let totalPnL = 0;
            let totalRisk = 0;
            let totalReward = 0;

            trades.forEach(trade => {
                const priceDiff = trade.type === 'long' ? trade.exitPrice - trade.entryPrice : trade.entryPrice - trade.exitPrice;
                const pnl = priceDiff * trade.positionSize;
                totalPnL += pnl;

                const risk = (trade.entryPrice - trade.stopLoss) * trade.positionSize;
                totalRisk += Math.abs(risk);

                if (pnl > 0) {
                    totalReward += pnl;
                }
            });

            const riskRewardRatio = totalRisk > 0 ? (totalReward / totalRisk).toFixed(2) : '0.00';

            document.getElementById('totalTrades').textContent = totalTrades;
            document.getElementById('winRate').textContent = winRate + '%';
            document.getElementById('totalPnL').textContent = '$' + totalPnL.toFixed(2);
            document.getElementById('totalPnL').className = 'stat-value ' + (totalPnL >= 0 ? 'positive' : 'negative');
            document.getElementById('riskReward').textContent = '1:' + riskRewardRatio;

            // Risk bar
            const recentTrades = trades.slice(-5);
            let avgRiskPercent = 0;
            if (recentTrades.length > 0) {
                let totalRiskPercent = 0;
                recentTrades.forEach(trade => {
                    const risk = Math.abs(trade.entryPrice - trade.stopLoss) / trade.entryPrice * 100;
                    totalRiskPercent += risk;
                });
                avgRiskPercent = totalRiskPercent / recentTrades.length;
            }

            const riskBarFill = Math.min(avgRiskPercent, 100);
            document.getElementById('riskBar').style.width = riskBarFill + '%';
            document.getElementById('riskText').textContent = `–°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5): ${avgRiskPercent.toFixed(1)}% –æ—Ç –≤—Ö–æ–¥–∞. ${avgRiskPercent > 3 ? '‚ö†Ô∏è –°–õ–ò–®–ö–û–ú –í–´–°–û–ö–û! –ù—É–∂–Ω–æ 1-2%' : '‚úÖ –í –Ω–æ—Ä–º–µ'}`;
        }

        function updateRecommendations() {
            const container = document.getElementById('recommendationsContainer');
            const recommendations = [];

            if (trades.length === 0) {
                recommendations.push({
                    text: '<strong>üìù –ö–∞–∫ –Ω–∞—á–∞—Ç—å:</strong> –î–æ–±–∞–≤—å —Å–≤–æ—é –ø–µ—Ä–≤—É—é —Å–¥–µ–ª–∫—É, –∏ —è –¥–∞–º —Ç–µ–±–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.',
                    type: 'info'
                });
            } else {
                // Rule 1: Check daily risk
                let todayRisk = 0;
                const today = new Date().toISOString().split('T')[0];
                trades.filter(t => t.date === today).forEach(t => {
                    const priceDiff = t.type === 'long' ? t.exitPrice - t.entryPrice : t.entryPrice - t.exitPrice;
                    todayRisk += Math.abs((priceDiff / t.entryPrice) * 100);
                });

                if (todayRisk > 5) {
                    recommendations.push({
                        text: '<strong>‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ —Ä–∏—Å–∫–∞ –∑–∞ –¥–µ–Ω—å:</strong> –°–µ–≥–æ–¥–Ω—è —Ç—ã —Ä–∏—Å–∫–æ–≤–∞–ª ' + todayRisk.toFixed(1) + '%. –ú–∞–∫—Å–∏–º—É–º 5-10% –≤ –¥–µ–Ω—å!',
                        type: 'warning'
                    });
                }

                // Rule 2: Check individual position risk
                const lastTrade = trades[trades.length - 1];
                const positionRisk = Math.abs((lastTrade.entryPrice - lastTrade.stopLoss) / lastTrade.entryPrice * 100);
                if (positionRisk > 3) {
                    recommendations.push({
                        text: '<strong>‚ö†Ô∏è –ë–æ–ª—å—à–æ–π —Ä–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É:</strong> –¢—ã —Ä–∏—Å–∫–æ–≤–∞–ª ' + positionRisk.toFixed(2) + '%. –õ—É—á—à–µ 1-2% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞!',
                        type: 'warning'
                    });
                } else if (positionRisk <= 2) {
                    recommendations.push({
                        text: '<strong>‚úÖ –ò–¥–µ–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫:</strong> ' + positionRisk.toFixed(2) + '% - —ç—Ç–æ –æ—Ç–ª–∏—á–Ω–æ! –ò–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π —Ä–∏—Å–∫ –Ω—É–∂–µ–Ω –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —É—Å–ø–µ—Ö–∞.',
                        type: 'positive'
                    });
                }

                // Rule 3: Check win rate
                const winners = trades.filter(t => t.type === 'long' ? t.exitPrice > t.entryPrice : t.exitPrice < t.entryPrice).length;
                const winRate = (winners / trades.length) * 100;

                if (trades.length >= 5) {
                    if (winRate < 40) {
                        recommendations.push({
                            text: '<strong>üìâ –ù–∏–∑–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥:</strong> ' + winRate.toFixed(0) + '%. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–≤–æ–∏ –≤—Ö–æ–¥—ã: –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç—ã –≤—Ö–æ–¥–∏—à—å –≤ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã?',
                            type: 'warning'
                        });
                    } else if (winRate >= 50) {
                        recommendations.push({
                            text: '<strong>‚úÖ –•–æ—Ä–æ—à–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–±–µ–¥:</strong> ' + winRate.toFixed(0) + '%! –¢—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–±–∏—Ä–∞–µ—à—å —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞. –ü—Ä–æ–¥–æ–ª–∂–∞–π —Ç–∞–∫!',
                            type: 'positive'
                        });
                    }
                }

                // Rule 4: Reason analysis
                const fomo = trades.filter(t => t.reason === 'fomo').length;
                if (fomo > 2) {
                    recommendations.push({
                        text: '<strong>üò± –ú–Ω–æ–≥–æ FOMO-—Å–¥–µ–ª–æ–∫:</strong> ' + fomo + ' –∏–∑ –Ω–∏—Ö. –≠—Ç–æ –≤—Ä–∞–≥! –¢–æ—Ä–≥—É–π —Ç–æ–ª—å–∫–æ –ø–æ –ø–ª–∞–Ω—É, –Ω–µ –ø–æ —ç–º–æ—Ü–∏—è–º.',
                        type: 'warning'
                    });
                }

                // Rule 5: Check position size consistency
                let avgPositionRisk = 0;
                trades.forEach(t => {
                    const risk = (Math.abs(t.entryPrice - t.stopLoss) * t.positionSize) / t.accountSize * 100;
                    avgPositionRisk += risk;
                });
                avgPositionRisk = avgPositionRisk / trades.length;

                if (avgPositionRisk > 2.5) {
                    recommendations.push({
                        text: '<strong>‚ö†Ô∏è –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫ —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π:</strong> ' + avgPositionRisk.toFixed(2) + '% –æ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞. –ü—Ä–∞–≤–∏–ª–æ 2% –≥–ª–∞—Å–∏—Ç: –Ω–µ —Ä–∏—Å–∫—É–π –±–æ–ª—å—à–µ 2% –Ω–∞ —Å–¥–µ–ª–∫—É!',
                        type: 'warning'
                    });
                } else if (avgPositionRisk <= 2) {
                    recommendations.push({
                        text: '<strong>üí™ –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∏—Ä–æ–≤–∞–Ω —Å —Ä–∏—Å–∫–æ–º:</strong> –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫ ' + avgPositionRisk.toFixed(2) + '%. –¢—ã —Å–ª–µ–¥—É–µ—à—å –ø—Ä–∞–≤–∏–ª—É 2% - —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ —É—Å–ø–µ—Ö–∞!',
                        type: 'positive'
                    });
                }

                // Rule 6: Three losses in a row
                let lossStreak = 0;
                let maxLossStreak = 0;
                for (let i = trades.length - 1; i >= 0; i--) {
                    const t = trades[i];
                    const isWin = t.type === 'long' ? t.exitPrice > t.entryPrice : t.exitPrice < t.entryPrice;
                    if (!isWin) {
                        lossStreak++;
                        maxLossStreak = Math.max(maxLossStreak, lossStreak);
                    } else {
                        lossStreak = 0;
                    }
                }

                if (maxLossStreak >= 3) {
                    recommendations.push({
                        text: '<strong>‚ö†Ô∏è –°–µ—Ä–∏—è –ø–æ—Ä–∞–∂–µ–Ω–∏–π:</strong> –ë—ã–ª–æ ' + maxLossStreak + ' –ø–æ—Ä–∞–∂–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥. –ü–æ—Å–ª–µ 3 –ø–æ—Ä–∞–∂–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥ - –ü–ï–†–ï–†–´–í! –¢–≤–æ–π –º–æ–∑–≥ –Ω–µ —Ç—Ä–µ–∑–≤.',
                        type: 'warning'
                    });
                }
            }

            // Ensure we have at least one recommendation
            if (recommendations.length === 0) {
                recommendations.push({
                    text: '<strong>‚ú® –û—Ç–ª–∏—á–Ω–æ!</strong> –¢—ã –¥–µ–ª–∞–µ—à—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–æ–¥–æ–ª–∂–∞–π —Ç–æ—Ä–≥–æ–≤–∞—Ç—å —Å –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–æ–π! üöÄ',
                    type: 'positive'
                });
            }

            container.innerHTML = recommendations.map(rec => 
                `<div class="recommendation-item" style="border-left-color: ${rec.type === 'positive' ? '#22c55e' : rec.type === 'warning' ? '#ff5459' : '#2180a8'}">${rec.text}</div>`
            ).join('');
        }

        function renderTrades() {
            const allBody = document.getElementById('allTradesBody');
            const winnersBody = document.getElementById('winnersTradesBody');
            const lossesBody = document.getElementById('lossesTradesBody');

            allBody.innerHTML = '';
            winnersBody.innerHTML = '';
            lossesBody.innerHTML = '';

            if (trades.length === 0) {
                allBody.innerHTML = '<tr><td colspan="9" class="empty-state"><p>–ù–µ—Ç —Å–¥–µ–ª–æ–∫. –î–æ–±–∞–≤—å –ø–µ—Ä–≤—É—é! üöÄ</p></td></tr>';
                winnersBody.innerHTML = '<tr><td colspan="5" class="empty-state"><p>–ï—â–µ –Ω–µ—Ç –ø–æ–±–µ–¥. –ë—É–¥—É—Ç! üí™</p></td></tr>';
                lossesBody.innerHTML = '<tr><td colspan="5" class="empty-state"><p>–ï—â–µ –Ω–µ—Ç –ø–æ—Ä–∞–∂–µ–Ω–∏–π. –ë—É–¥—É—Ç —É—á–∏—Ç—å—Å—è! üìö</p></td></tr>';
                return;
            }

            // Sort trades by date (newest first)
            const sortedTrades = [...trades].sort((a, b) => new Date(b.date) - new Date(a.date));

            sortedTrades.forEach(trade => {
                const priceDiff = trade.type === 'long' ? trade.exitPrice - trade.entryPrice : trade.entryPrice - trade.exitPrice;
                const pnl = priceDiff * trade.positionSize;
                const pnlPercent = (priceDiff / trade.entryPrice * 100).toFixed(2);
                const risk = Math.abs(trade.entryPrice - trade.stopLoss) * trade.positionSize;
                const isWin = pnl >= 0;

                const typeDisplay = trade.type === 'long' ? 'üìà –õ–û–ù–ì' : 'üìâ –®–û–†–¢';
                const pnlClass = isWin ? 'trade-positive' : 'trade-negative';
                const pnlText = (isWin ? '+' : '') + pnl.toFixed(2);

                // All trades
                const allRow = `
                    <tr>
                        <td>${trade.date}</td>
                        <td><strong>${trade.coin}</strong></td>
                        <td>${typeDisplay}</td>
                        <td>$${trade.entryPrice.toFixed(2)} / $${trade.exitPrice.toFixed(2)}</td>
                        <td>${trade.positionSize}</td>
                        <td>$${risk.toFixed(2)}</td>
                        <td class="${pnlClass}">$${pnlText}</td>
                        <td class="${pnlClass}">${(isWin ? '+' : '')}${pnlPercent}%</td>
                        <td><button class="btn btn-danger" onclick="deleteTrade(${trade.id})">üóëÔ∏è</button></td>
                    </tr>
                `;
                allBody.innerHTML += allRow;

                // Winners/Losers
                if (isWin) {
                    const winRow = `
                        <tr>
                            <td>${trade.date}</td>
                            <td><strong>${trade.coin}</strong></td>
                            <td>$${trade.entryPrice.toFixed(2)} ‚Üí $${trade.exitPrice.toFixed(2)}</td>
                            <td class="trade-positive">+$${pnl.toFixed(2)}</td>
                            <td class="trade-positive">+${pnlPercent}%</td>
                        </tr>
                    `;
                    winnersBody.innerHTML += winRow;
                } else {
                    const loseRow = `
                        <tr>
                            <td>${trade.date}</td>
                            <td><strong>${trade.coin}</strong></td>
                            <td>$${trade.entryPrice.toFixed(2)} ‚Üí $${trade.exitPrice.toFixed(2)}</td>
                            <td class="trade-negative">-$${Math.abs(pnl).toFixed(2)}</td>
                            <td class="trade-negative">${pnlPercent}%</td>
                        </tr>
                    `;
                    lossesBody.innerHTML += loseRow;
                }
            });

            if (winnersBody.innerHTML === '') {
                winnersBody.innerHTML = '<tr><td colspan="5" class="empty-state"><p>–ï—â–µ –Ω–µ—Ç –ø–æ–±–µ–¥. –ë—É–¥—É—Ç! üí™</p></td></tr>';
            }
            if (lossesBody.innerHTML === '') {
                lossesBody.innerHTML = '<tr><td colspan="5" class="empty-state"><p>–ï—â–µ –Ω–µ—Ç –ø–æ—Ä–∞–∂–µ–Ω–∏–π. –ë—É–¥—É—Ç —É—á–∏—Ç—å—Å—è! üìö</p></td></tr>';
            }
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function deleteTrade(id) {
            if (confirm('–¢—ã —É–≤–µ—Ä–µ–Ω? –≠—Ç—É —Å–¥–µ–ª–∫—É –Ω–µ–ª—å–∑—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å!')) {
                trades = trades.filter(t => t.id !== id);
                localStorage.setItem('trades', JSON.stringify(trades));
                updateUI();
            }
        }

        function exportToCSV() {
            if (trades.length === 0) {
                alert('–ù–µ—Ç —Å–¥–µ–ª–æ–∫ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞!');
                return;
            }

            let csv = '–î–∞—Ç–∞,–ú–æ–Ω–µ—Ç–∞,–¢–∏–ø,–í—Ö–æ–¥,–í—ã—Ö–æ–¥,–°—Ç–æ–ø,–†–∞–∑–º–µ—Ä,P&L,–†–∏—Å–∫,–ü—Ä–∏—á–∏–Ω–∞,–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π\n';
            
            trades.forEach(trade => {
                const priceDiff = trade.type === 'long' ? trade.exitPrice - trade.entryPrice : trade.entryPrice - trade.exitPrice;
                const pnl = (priceDiff * trade.positionSize).toFixed(2);
                const risk = (Math.abs(trade.entryPrice - trade.stopLoss) * trade.positionSize).toFixed(2);
                
                csv += `${trade.date},"${trade.coin}","${trade.type}","${trade.entryPrice}","${trade.exitPrice}","${trade.stopLoss}","${trade.positionSize}","${pnl}","${risk}","${trade.reason}","${trade.comment}"\n`;
            });

            const link = document.createElement('a');
            link.href = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);
            link.download = 'trading_journal_' + new Date().toISOString().split('T')[0] + '.csv';
            link.click();
        }

        // Initial render
        updateUI();
    </script>
</body>
</html>
